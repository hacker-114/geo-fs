<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Game Runner</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body { margin:0; font-family:system-ui,sans-serif; background:#0b0f14; color:#cfe3ff; }
    #canvas { width:100%; height:100%; display:block; }
    #log { font-family:ui-monospace,monospace; font-size:12px; white-space:pre-wrap; }
  </style>
</head>
<body>
  <main>
    <canvas id="canvas" width="960" height="540"></canvas>
    <div id="log"></div>
  </main>

  <script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    const logEl = document.getElementById('log');
    let gameAPI = null, rafId=null;

    function log(...args){ logEl.textContent += args.join(' ') + "\n"; console.log(...args); }

    async function loadScript(){
      try {
        const mod = await import(resolvePath('script.js'));
        gameAPI = mod.default || mod.Game || mod.game || mod;
        log('Loaded script.js');
      } catch(e){ log('Error loading script.js', e); }
    }

    function resolvePath(p){
      const a=document.createElement('a'); a.href=p; return a.href;
    }

    function loop(){
      if(gameAPI && typeof gameAPI.frame==='function'){
        try{ gameAPI.frame(ctx, canvas); }catch(e){ log('frame() error', e); cancelAnimationFrame(rafId); return; }
      }
      rafId=requestAnimationFrame(loop);
    }

    async function launchGame(){
      await loadScript();
      if(gameAPI && typeof gameAPI.init==='function'){ gameAPI.init(ctx, canvas); }
      if(gameAPI && typeof gameAPI.start==='function'){ gameAPI.start(ctx, canvas); }
      loop();
      log('Game launched automatically.');
    }

    // Autoâ€‘launch when page loads
    launchGame();

    // Paint initial background
    ctx.fillStyle='#9cc4ff'; ctx.fillText('Launching game...',16,28);
  </script>
</body>
</html>
